!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,n){return void 0===n&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(n),n}:e(jQuery)}(function(e){"use strict";function t(t){t.preventDefault();var n=e(this).data("modal");n.addClass("is-open")}function n(t){t.preventDefault(),e(this).removeClass("is-open")}function a(t){var a=e('<div class="cm-modal">');return a.append(e('<div class="js-close-modal cm-overlay">')),a.append(o(t).addClass("cm-form--modal")),a.on("click",".js-close-modal",n.bind(a)),a}function o(t){var n=t.endpoint,a=t.fields,o=e("<form>").attr({id:"contact-me-"+t.id||t.name,name:"contact-me-"+t.id||t.name,"class":"cm-form",action:n,method:"POST"});o.append(e('<div class="cm-form__message">')),o.append(i("token",t.token)),o.append(i("secret",t.secret));for(var m in a){var l=a[m];"boolean"==typeof l?o.append(r(m,l)):l.length&&o.append(s(m,l))}return o.append(d(t.modal)),o.on("submit",t.onSubmit),o}function i(t,n){return e("<input>").attr({type:"hidden",name:t,value:n})}function r(t,n){var a=e('<div class="cm-form__field">'),o=e("<label>").html(t.toUpperCase());return o.append(e("<input>").attr({"class":"cm-form__input cm-form__"+t+" u-full-width",type:"email"===t?"email":"password"===t?"password":"text",placeholder:"Enter your "+t,required:n,name:t})),a.append(o)}function s(t,n){var a=e('<div class="cm-form__field">'),o=e("<label>").html(t.toUpperCase()),i=e("<select>").attr({id:t,"class":"cm-form__input cm-form__"+t+" u-full-width",name:t});for(var r in n){var s=n[r];i.append(e("<option>").val(s.toLowerCase()).html(s))}return o.append(i),a.append(o)}function d(t){var n=e('<div class="cm-form__field">');return n.append(e("<button>").attr({type:"submit","class":"cm-form__button button-primary"}).html("Submit")),n.append(e('<button type="reset">').css("display","none")),t&&n.append(e("<button>").attr({type:"button","class":"js-close-modal cm-form__button"}).html("Close")),n}function m(t){t.preventDefault();var n=e(this),a=n.attr("action");e.post(a,n.serialize()).done(function(e,t){n.flashMessage(t,"Successfully inserted: "+e.name),n.find("[type=reset]").trigger("click")}).fail(function(e,t,a){n.flashMessage(t,a),n.find(":invalid").focus()})}e.fn.contactMe=function(n){var i=e.extend(!0,{id:1,fields:{name:!0,email:!0},onSubmit:m},n);return this.each(function(){if(i.endpoint=i.endpoint||this.dataset.endpoint,i.modal=!1,!i.endpoint)throw new ReferenceError("You have to define an endpoint for the form.");var n,r,s=e(this);s.is("a")?(i.modal=!0,r=a(i),n=r.find(".cm-form"),e(document.body).append(r),s.on("click",t)):(r=null,n=o(i),s.html(n)),i.id++,s.data("modal",r),s.data("form",n)})},e.fn.flashMessage=function(t,n){var a="cm-form__message--"+t,o=e(this).find(".cm-form__message");return o.text(n).addClass(a),setTimeout(function(){o.removeClass(a)},5e3),this}});